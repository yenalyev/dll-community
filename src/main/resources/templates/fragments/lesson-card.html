<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lesson Card Fragment</title>
</head>
<body>

<!--
    ФРАГМЕНТ: Картка уроку

    Використання:
    <div th:replace="~{fragments/lesson-card :: lesson-card(lesson=${lessonCard})}"></div>

    Параметри:
    - lesson: об'єкт LessonCardDto з усіма необхідними даними
-->

<div th:fragment="lesson-card(lesson)" class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition">
    <!-- Зображення та іконки -->
    <div class="relative">
        <!-- Головне зображення -->
        <img th:src="${lesson.mainImageUrl != null ? lesson.mainImageUrl : 'https://via.placeholder.com/300x200/FDD95F/000000?text=Lesson'}"
             th:alt="${lesson.title}"
             class="w-full h-48 object-cover">

        <!-- Кнопка "Додати в обране" (верхній лівий кут) -->
        <button class="absolute top-2 left-2 text-gray-900 hover:scale-110 transition-transform"
                aria-label="Add to favorites">
            <svg class="w-7 h-7" viewBox="0 0 32 32" fill="none">
                <circle cx="16" cy="16" r="16" fill="#FDD95F"/>
                <path d="M16 24.2L16.927 23.541C17.953 22.768 18.68 22.221 19.387 21.633C21.641 19.625 23.514 17.067 23.514 14.477C23.514 12.279 22.641 11.185 21.7 9.659C20.713 9.72 19.699 10.274 18.358 11.186L16 13.748L13.642 11.186C12.301 10.274 11.287 9.72 10.3 9.659C9.359 11.185 8.486 12.279 8.486 14.477C8.486 17.067 10.359 19.625 12.613 21.633C13.32 22.221 14.047 22.768 15.073 23.541L16 24.2Z"
                      stroke="#212121" stroke-width="1.5"/>
            </svg>
        </button>

        <!-- Атрибути для header (рівень складності) - верхній правий кут -->
        <div class="absolute top-2 right-2 flex gap-2">
            <span th:each="attr : ${lesson.cardHeaderAttributes}"
                  class="bg-warning text-gray-900 text-xs font-semibold px-2 py-1 rounded"
                  th:text="${attr}">
                C1
            </span>
        </div>
    </div>

    <!-- Контент картки -->
    <div class="p-4">
        <!-- Атрибути для body (категорія/тип) -->
        <div class="text-gray-500 text-sm mb-2">
            <span th:if="${#lists.isEmpty(lesson.cardBodyAttributes)}" th:text="'Activity'">Activity</span>
            <span th:if="${!#lists.isEmpty(lesson.cardBodyAttributes)}"
                  th:text="${#strings.listJoin(lesson.cardBodyAttributes, ', ')}">
                Speaking activity
            </span>
        </div>

        <!-- Назва уроку -->
        <h3 class="text-lg font-semibold text-gray-900 mb-2"
            th:text="${lesson.title}">
            Autumn Debate Cafe
        </h3>

        <!-- Опис уроку (обрізаємо, якщо занадто довгий) -->
        <p class="text-gray-600 text-sm mb-4 line-clamp-3"
           th:text="${lesson.description}">
            In this activity, students debate autumn-related statements and defend their opinions.
        </p>

        <!-- Кнопка "Show" та рівень доступу -->
        <div class="flex items-center justify-between">
            <!-- Посилання на урок -->
            <a th:href="@{/{lang}/lessons/{slug}(lang=${#locale.language}, slug=${lesson.slug})}"
               class="bg-warning text-gray-900 font-semibold py-2 px-4 rounded hover:bg-yellow-500 transition">
                Show
            </a>

            <!-- Рівень доступу (Free / DLL Pro) -->
            <span class="text-gray-900 font-semibold text-sm"
                  th:text="${lesson.accessLevel}">
                Free
            </span>
        </div>
    </div>
</div>

<!--
    АЛЬТЕРНАТИВНИЙ ВАРІАНТ: Картка без параметрів
    Якщо потрібно відобразити список карток у циклі:

    <div th:each="card : ${lessonCards}">
        <div th:replace="~{fragments/lesson-card :: lesson-card-simple}"></div>
    </div>
-->

<div th:fragment="lesson-card-simple" class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition">
    <div class="relative">
        <img th:src="${mainImageUrl != null ? mainImageUrl : 'https://via.placeholder.com/300x200/FDD95F/000000?text=Lesson'}"
             th:alt="${title}"
             class="w-full h-48 object-cover">

        <button class="absolute top-2 left-2 text-gray-900 hover:scale-110 transition-transform"
                aria-label="Add to favorites">
            <svg class="w-7 h-7" viewBox="0 0 32 32" fill="none">
                <circle cx="16" cy="16" r="16" fill="#FDD95F"/>
                <path d="M16 24.2L16.927 23.541C17.953 22.768 18.68 22.221 19.387 21.633C21.641 19.625 23.514 17.067 23.514 14.477C23.514 12.279 22.641 11.185 21.7 9.659C20.713 9.72 19.699 10.274 18.358 11.186L16 13.748L13.642 11.186C12.301 10.274 11.287 9.72 10.3 9.659C9.359 11.185 8.486 12.279 8.486 14.477C8.486 17.067 10.359 19.625 12.613 21.633C13.32 22.221 14.047 22.768 15.073 23.541L16 24.2Z"
                      stroke="#212121" stroke-width="1.5"/>
            </svg>
        </button>

        <div class="absolute top-2 right-2 flex gap-2">
            <span th:each="attr : ${cardHeaderAttributes}"
                  class="bg-warning text-gray-900 text-xs font-semibold px-2 py-1 rounded"
                  th:text="${attr}">
            </span>
        </div>
    </div>

    <div class="p-4">
        <div class="text-gray-500 text-sm mb-2">
            <span th:if="${#lists.isEmpty(cardBodyAttributes)}" th:text="'Activity'"></span>
            <span th:if="${!#lists.isEmpty(cardBodyAttributes)}"
                  th:text="${#strings.listJoin(cardBodyAttributes, ', ')}">
            </span>
        </div>

        <h3 class="text-lg font-semibold text-gray-900 mb-2" th:text="${title}"></h3>

        <p class="text-gray-600 text-sm mb-4 line-clamp-3" th:text="${description}"></p>

        <div class="flex items-center justify-between">
            <a th:href="@{/{lang}/lessons/{slug}(lang=${#locale.language}, slug=${slug})}"
               class="bg-warning text-gray-900 font-semibold py-2 px-4 rounded hover:bg-yellow-500 transition">
                Show
            </a>

            <span class="text-gray-900 font-semibold text-sm" th:text="${accessLevel}"></span>
        </div>
    </div>
</div>

</body>
</html>
