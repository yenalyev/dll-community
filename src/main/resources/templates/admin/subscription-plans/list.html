<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/admin}">
<head>
    <title>–ü–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–æ–∫</title>
</head>
<body>
<div layout:fragment="content">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold">–ü–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–æ–∫</h1>
            <a th:href="@{/admin/subscription-plans/new}"
               class="bg-yellow-400 hover:bg-yellow-500 text-black font-semibold px-6 py-2 rounded-lg transition">
                + –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–ª–∞–Ω
            </a>
        </div>

        <!-- Success/Error Messages -->
        <div th:if="${successMessage}"
             class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"
             role="alert">
            <span th:text="${successMessage}"></span>
        </div>
        <div th:if="${errorMessage}"
             class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"
             role="alert">
            <span th:text="${errorMessage}"></span>
        </div>

        <!-- Plans List -->
        <div th:if="${plans.isEmpty()}"
             class="bg-white rounded-lg shadow p-8 text-center text-gray-500">
            <p class="text-xl">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∂–æ–¥–Ω–æ–≥–æ –ø–ª–∞–Ω—É –ø—ñ–¥–ø–∏—Å–∫–∏</p>
            <a th:href="@{/admin/subscription-plans/new}"
               class="inline-block mt-4 text-yellow-600 hover:text-yellow-700 font-semibold">
                –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–µ—Ä—à–∏–π –ø–ª–∞–Ω ‚Üí
            </a>
        </div>

        <div th:unless="${plans.isEmpty()}" class="grid gap-6">
            <div th:each="plan : ${plans}"
                 class="bg-white rounded-lg shadow-lg overflow-hidden border-2"
                 th:classappend="${plan.isActive} ? 'border-green-500' : 'border-gray-300'">

                <!-- Plan Header -->
                <div class="bg-gradient-to-r from-yellow-400 to-yellow-500 px-6 py-4">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-2xl font-bold text-black mb-1">
                                <span th:text="${plan.durationInDays}">30</span> –¥–Ω—ñ–≤
                            </h3>
                            <span th:if="${plan.isActive}"
                                  class="inline-block bg-green-500 text-white text-xs px-2 py-1 rounded">
                                –ê–∫—Ç–∏–≤–Ω–∏–π
                            </span>
                            <span th:unless="${plan.isActive}"
                                  class="inline-block bg-gray-500 text-white text-xs px-2 py-1 rounded">
                                –ù–µ–∞–∫—Ç–∏–≤–Ω–∏–π
                            </span>
                        </div>

                        <!-- Actions -->
                        <div class="flex gap-2">
                            <a th:href="@{/admin/subscription-plans/{id}/edit(id=${plan.id})}"
                               class="bg-white hover:bg-gray-100 text-black px-4 py-2 rounded transition">
                                ‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                            </a>

                            <form th:action="@{/admin/subscription-plans/{id}/toggle-status(id=${plan.id})}"
                                  method="post" class="inline">
                                <button type="submit"
                                        class="bg-white hover:bg-gray-100 text-black px-4 py-2 rounded transition">
                                    <span th:if="${plan.isActive}">üîí –î–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏</span>
                                    <span th:unless="${plan.isActive}">‚úÖ –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏</span>
                                </button>
                            </form>

                            <form th:action="@{/admin/subscription-plans/{id}/delete(id=${plan.id})}"
                                  method="post"
                                  onsubmit="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π –ø–ª–∞–Ω?')"
                                  class="inline">
                                <button type="submit"
                                        class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition">
                                    üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Plan Details -->
                <div class="p-6">
                    <!-- Translations -->
                    <div class="mb-4">
                        <h4 class="font-semibold text-gray-700 mb-2">üìù –ü–µ—Ä–µ–∫–ª–∞–¥–∏:</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div th:each="translation : ${plan.translations}"
                                 class="bg-gray-50 p-4 rounded-lg border">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="font-bold text-sm uppercase"
                                          th:text="${translation.lang}">UA</span>
                                    <span th:if="${translation.lang == 'ua'}">üá∫üá¶</span>
                                    <span th:if="${translation.lang == 'en'}">üá¨üáß</span>
                                    <span th:if="${translation.lang == 'de'}">üá©üá™</span>
                                </div>
                                <p class="font-semibold text-lg mb-1"
                                   th:text="${translation.name}">–ù–∞–∑–≤–∞ –ø–ª–∞–Ω—É</p>
                                <p class="text-sm text-gray-600"
                                   th:text="${translation.description}">–û–ø–∏—Å –ø–ª–∞–Ω—É</p>
                            </div>
                        </div>
                    </div>

                    <!-- Prices -->
                    <div>
                        <h4 class="font-semibold text-gray-700 mb-2">üí∞ –¶—ñ–Ω–∏:</h4>
                        <div class="flex flex-wrap gap-3">
                            <div th:each="price : ${plan.prices}"
                                 class="bg-yellow-50 border-2 border-yellow-400 px-4 py-2 rounded-lg">
                                <span class="font-bold" th:text="${price.currency}">UAH</span>:
                                <span class="text-xl font-bold ml-2"
                                      th:text="${#numbers.formatDecimal(price.amount / 100.0, 1, 2)}">100.00</span>
                                <span th:switch="${price.currency}">
                                    <span th:case="'UAH'">‚Ç¥</span>
                                    <span th:case="'EUR'">‚Ç¨</span>
                                    <span th:case="'USD'">$</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>